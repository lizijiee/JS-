import CandleStick from'./candlestick';import isValidNumber from'../../../../../fc-utils/src/type/is-valid-number';import{pluckNumber}from'../../../../../fc-core/src/lib';class OHLC extends CandleStick{constructor(){super(),this.getHoverInConfig=function(a){let b=this.config;return{style:{"stroke-width":pluckNumber(b['stroke-width'],2)},index:a,hovered:!0}},this.getHoverOutConfig=function(a){let b=this.config;return{style:{"stroke-width":pluckNumber(b['stroke-width'],b['default-stroke-width'])},index:a,hovered:!1}}}__setDefaultConfig(){super.__setDefaultConfig(),this.config['default-stroke-width']=1,this.config['default-stroke-linecap']='round',this.config['default-stroke-linejoin']='miter',this.config['default-stroke-dasharray']='none',this.config.bearConfig['default-stroke']='868AC8'}_drawPlot(){var a=this,b=a.config,c=b.dataInfo;c.forEach(b=>{b.groupConfig&&(a.addGraphicalElement({el:'path',container:{label:'group',id:'meso-'+b.groupId},label:'highlow',attr:{path:`M${b.midX},${b.lowStickYEntend},V${b.highStickYExtend}`,"stroke-width":b['stroke-width']}},!0),a.addGraphicalElement({el:'path',container:{label:'group',id:'meso-'+b.groupId},label:'open',attr:{path:`M${b.midX},${b.open},H${b.leftExtend}`,"stroke-width":b['stroke-width']}},!0),a.addGraphicalElement({el:'path',container:{label:'group',id:'meso-'+b.groupId},label:'close',attr:{path:`M${b.midX},${b.close},H${b.rightExtend}`,"stroke-width":b['stroke-width']}},!0))})}allocatePosition(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s=this,t=s.getFromEnv('xScale'),u=s.getFromEnv('yScale'),v=s.config,[w,x,y,z,A]=v.indices,B=v.dataInfo=[],C=v.data;j=v.timeStampGap=t.getRangeThreshold()[2],p=t.getRangeValue(t.getRangeThreshold()[2])-t.getRangeValue(0),a=p*(1-v.plotSpacePercent/100),C.forEach((m,p)=>{b=m[w],c=(t.getRangeValue(new Date(b.end))+t.getRangeValue(new Date(b.start)))/2,d=m[x],e=m[A],f=m[y],g=m[z],p||(i=v.firstTimeStamp=b.start),o=u.getRangeValue(f),n=u.getRangeValue(g),q=u.getRangeValue(e),r=u.getRangeValue(d),isValidNumber(o)&&isValidNumber(n)&&isValidNumber(q)&&isValidNumber(r)&&(l=d>e?'bull':'bear',k={startDate:b.start,endDate:b.end},k.rightExtend=c+a/2,k.leftExtend=k.x=c-a/2,k.y=o,k.width=a,k.close=q,k.openValue=d,k.closeValue=e,k.highValue=f,k.lowValue=g,k.open=r,k.midX=c,k.groupId=l,k.lowStickYEntend=n,k.highStickYExtend=o,k.height=n-o,k.colY=k.height/2,k['stroke-width']=pluckNumber(v['default-stroke-width'],1),k.groupConfig='bull'===l?'bullConfig':'bearConfig',h=Math.round((b.start-i)/j),B[h]=k)}),(m=v.hoverInfo)&&m.forEach(a=>{'object'==typeof B[a.index]&&'object'==typeof a.style&&(B[a.index]['stroke-width']=a.style['stroke-width'])})}getName(){return'ohlc'}}export default OHLC;