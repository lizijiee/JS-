{"ast":null,"code":"import _classCallCheck from \"F:\\\\App Store\\\\Coding\\\\Github_Download\\\\JS-\\\\React\\u9879\\u76EE\\\\react-mall\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"F:\\\\App Store\\\\Coding\\\\Github_Download\\\\JS-\\\\React\\u9879\\u76EE\\\\react-mall\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"F:\\\\App Store\\\\Coding\\\\Github_Download\\\\JS-\\\\React\\u9879\\u76EE\\\\react-mall\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _assertThisInitialized from \"F:\\\\App Store\\\\Coding\\\\Github_Download\\\\JS-\\\\React\\u9879\\u76EE\\\\react-mall\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";\nimport _getPrototypeOf from \"F:\\\\App Store\\\\Coding\\\\Github_Download\\\\JS-\\\\React\\u9879\\u76EE\\\\react-mall\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _get from \"F:\\\\App Store\\\\Coding\\\\Github_Download\\\\JS-\\\\React\\u9879\\u76EE\\\\react-mall\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/get\";\nimport _inherits from \"F:\\\\App Store\\\\Coding\\\\Github_Download\\\\JS-\\\\React\\u9879\\u76EE\\\\react-mall\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport ComponentBase, { addAllEventsOnGraphic, removeAllEventsFromGraphic } from './component-base';\n\nvar UNDEF,\n    addEventOnAllGraphics = function addEventOnAllGraphics(a, b, c) {\n  var d;\n  b && c && (d = function d(a) {\n    !a._skipEvents && a.on && a.on(b, c);\n  }, _mapSubFnForward(a.getGraphicalElement(), d));\n},\n    removeEventFromAllGraphics = function removeEventFromAllGraphics(a, b, c) {\n  var d;\n  b && c && (d = function d(a) {\n    !a._skipEvents && a.off && a.off(b, c);\n  }, _mapSubFnForward(a.getGraphicalElement(), d));\n},\n    _mapSubFnBackward = function _mapSubFnBackward(a, b) {\n  if (a && a.hasOwnProperty && b && b.call) {\n    var c, d, e, f;\n\n    for (d in a) {\n      for (c = a[d], e = c.elemStore, f = e && e.length - 1; 0 <= f && !b(e[f], d, f); f--) {\n        ;\n      }\n    }\n  }\n},\n    _mapSubFnForward = function _mapSubFnForward(a, b) {\n  if (a && a.hasOwnProperty && b && b.call) {\n    var c, d, e, f, g;\n\n    for (e in a) {\n      for (c = a[e], f = c.elemStore, (g = 0, d = f && f.length); g < d && !b(f[g], e, g); g++) {\n        ;\n      }\n    }\n  }\n};\n\nvar SmartRenderer =\n/*#__PURE__*/\nfunction (_ComponentBase) {\n  _inherits(SmartRenderer, _ComponentBase);\n\n  function SmartRenderer(a) {\n    var _this;\n\n    _classCallCheck(this, SmartRenderer);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(SmartRenderer).call(this));\n\n    var b = _assertThisInitialized(_this);\n\n    b._id = a, b._componentStore = {}, b._oldComponentStore = [], b.fireEvent('instantiated'), b.__setDefaultConfig();\n    return _this;\n  }\n\n  _createClass(SmartRenderer, [{\n    key: \"syncDraw\",\n    value: function syncDraw() {\n      this._removeUnusedComponent(), this._resetGraphicalStore(), _get(_getPrototypeOf(SmartRenderer.prototype), \"syncDraw\", this).call(this), this._removeUnusedGraphics();\n    }\n  }, {\n    key: \"setDimension\",\n    value: function setDimension(a, b) {\n      this.config.width = a, this.config.height = b;\n    }\n  }, {\n    key: \"setTranslation\",\n    value: function setTranslation(a, b) {\n      var c = this,\n          d = c.config;\n      d._translateX = a, d._translateY = b, d.translate = \"t\".concat(a, \",\").concat(b);\n    }\n  }, {\n    key: \"getTranslation\",\n    value: function getTranslation() {\n      return {\n        x: this.config._translateX,\n        y: this.config._translateY\n      };\n    }\n  }, {\n    key: \"_resetGraphicalStore\",\n    value: function _resetGraphicalStore() {\n      var a = this;\n      a._oldGraphicalStore = a._graphicalStore, a._graphicalStore = {};\n    }\n  }, {\n    key: \"_getLastUsedElem\",\n    value: function _getLastUsedElem() {\n      return this.config.lastElemUsed;\n    }\n  }, {\n    key: \"addGraphicalElement\",\n    value: function addGraphicalElement() {\n      var a = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var b = arguments.length > 1 ? arguments[1] : undefined;\n      var c,\n          d,\n          e,\n          f,\n          g = this,\n          h = g.getFromEnv('animationManager'),\n          i = a.label,\n          j = g._graphicalStore[i] || (g._graphicalStore[i] = {\n        elemStore: [],\n        idMap: {},\n        indexMap: {},\n        lastIndexUsed: -1\n      }),\n          k = !0,\n          l = g._oldGraphicalStore && g._oldGraphicalStore[i],\n          m = j.lastIndexUsed += 1,\n          n = a.id;\n      l && (n && l.idMap[n] !== void 0 ? (e = l.idMap[n], f = l.elemStore[e], delete l.elemStore[e], delete l.indexMap[e], delete l.idMap[n]) : l.elemStore[m] && !l.indexMap[m] && (f = l.elemStore[m], delete l.elemStore[m])), f && (a.el = f, k = !1), (d = a.container) ? (c = d.isParent ? g.getLinkedParent() : g, a.container = c.getGraphicalElement(d.id, d.label) || c.getChildContainer(d.id)) : a.container = g.getFromEnv('chart-container'), f = h.setAnimation(a), j.elemStore[m] = f, n && (j.idMap[n] && (delete j.indexMap[j.idMap[n]], delete j.idMap[n]), j.idMap[n] = m, j.indexMap[m] = n), g.fireEvent('graphicalelementattached', {\n        element: f\n      }), f._skipEvents = b, a.shadow && f.shadow(a.shadow), a.tooltext && g.getFromEnv('toolTipController').enableToolTip(f, a.tooltext), g.config.lastElemUsed = f, !b && k && addAllEventsOnGraphic(f, g._middleListeners, g);\n    }\n  }, {\n    key: \"removeGraphicalElement\",\n    value: function removeGraphicalElement(a, b) {\n      var c,\n          d,\n          e,\n          f,\n          g = this,\n          h = g._graphicalStore;\n      'object' == typeof a ? _mapSubFnBackward(h, function (b, d, e) {\n        if (a === b) return f = !0, b._skipEvents || removeAllEventsFromGraphic(b, g._middleListeners), g._setRemoveAnim(b, d), c = h[d], c.elemStore.splice(e, 1), delete c.idMap[c.indexMap[e]], delete c.indexMap[e], !0;\n      }) : _mapSubFnBackward(h, function (d, j, k) {\n        if (c = h[j], e = c.indexMap, e[k] === a && (!b || b === j)) return f = !0, d._skipEvents || removeAllEventsFromGraphic(d, g._middleListeners), g._setRemoveAnim(d, j), c.elemStore.splice(k, 1), delete c.idMap[c.indexMap[k]], delete c.indexMap[k], !0;\n      }), f && this.fireEvent('graphicalelementremoved', {\n        element: d\n      });\n    }\n  }, {\n    key: \"getChildContainer\",\n    value: function getChildContainer(a) {\n      return this.getGraphicalElement(UNDEF, a);\n    }\n  }, {\n    key: \"_removeUnusedGraphics\",\n    value: function _removeUnusedGraphics() {\n      var a,\n          b = this,\n          c = b._oldGraphicalStore;\n\n      _mapSubFnBackward(c, function (d, e, f) {\n        d && (!d._skipEvents && removeAllEventsFromGraphic(d, b._middleListeners), b._setRemoveAnim(d, e), a = c[e], delete a.idMap[a.indexMap[f]], delete a.indexMap[f]);\n      });\n    }\n  }, {\n    key: \"getGraphicalElement\",\n    value: function getGraphicalElement(a, b) {\n      var c,\n          d,\n          e,\n          f,\n          g,\n          h = this,\n          j = h._graphicalStore;\n      return b || a ? b ? (c = j[b], a ? c && c.elemStore && c.elemStore[c.idMap[a]] : c && c.elemStore && c.elemStore[0]) : (_mapSubFnForward(j, function () {\n        if (g = arguments[2], e = j[arguments[1]], d = e.idMap, d[g] === a) return f = e.elemStore[g], !0;\n      }), f) : j;\n    }\n  }, {\n    key: \"addEventListener\",\n    value: function addEventListener(a, b, c) {\n      var d = _get(_getPrototypeOf(SmartRenderer.prototype), \"addEventListener\", this).call(this, a, b, c);\n\n      return !0 === d ? (addEventOnAllGraphics(this, a, this._middleListeners[a]), b) : !!d && b;\n    }\n  }, {\n    key: \"removeEventListener\",\n    value: function removeEventListener(a, b) {\n      _get(_getPrototypeOf(SmartRenderer.prototype), \"removeEventListener\", this).call(this, a, b) && removeEventFromAllGraphics(this, a, this._middleListeners[a]);\n    }\n  }, {\n    key: \"_dispose\",\n    value: function _dispose() {\n      var a,\n          b = this;\n\n      if (_get(_getPrototypeOf(SmartRenderer.prototype), \"_dispose\", this).call(this)) {\n        for (a in b.getFromEnv('paper') && !b.getFromEnv('paper').removed && _mapSubFnForward(b.getGraphicalElement(), b.__instantRemoveFn), b) {\n          b.hasOwnProperty(a) && delete b[a];\n        }\n\n        b.fireEvent('removed');\n      }\n    }\n  }, {\n    key: \"removingDraw\",\n    value: function removingDraw() {\n      var a = this;\n\n      _mapSubFnForward(a.getGraphicalElement(), a._setRemoveAnim);\n    }\n  }, {\n    key: \"configure\",\n    value: function configure(a) {\n      this._resetComponentStore(), _get(_getPrototypeOf(SmartRenderer.prototype), \"configure\", this).call(this, a);\n    }\n  }, {\n    key: \"_resetComponentStore\",\n    value: function _resetComponentStore() {\n      var a = this;\n      a._oldComponentStore.push(a._componentStore), a._componentStore = {};\n    }\n  }, {\n    key: \"_mapChildren\",\n    value: function _mapChildren(a, b) {\n      b ? _mapSubFnBackward(this.getChildren(), a) : _mapSubFnForward(this.getChildren(), a);\n    }\n  }, {\n    key: \"attachChild\",\n    value: function attachChild(a, b, c) {\n      var d,\n          e,\n          f = this,\n          g = f._componentStore[b] || (f._componentStore[b] = {\n        elemStore: [],\n        idMap: {},\n        indexMap: {},\n        lastIndexUsed: -1\n      }),\n          h = f._oldComponentStore && f._oldComponentStore.length && f._oldComponentStore[f._oldComponentStore.length - 1][b],\n          i = g.lastIndexUsed += 1;\n      return h && (c && void 0 !== h.idMap[c] ? (d = h.idMap[c], e = h.elemStore[d], delete h.elemStore[d], delete h.indexMap[d], delete h.idMap[c]) : h.elemStore[i] && !h.indexMap[i] && (e = h.elemStore[i], delete h.elemStore[i])), e || (e = new a(c)), g.elemStore[i] = e, c && (g.idMap[c] = i, g.indexMap[i] = c), e._setLinkedParent(f), f.fireEvent('childattached', {\n        attachedChild: e\n      }), e;\n    }\n  }, {\n    key: \"_removeUnusedComponent\",\n    value: function _removeUnusedComponent() {\n      var a = this,\n          b = a._oldComponentStore,\n          c = b.length,\n          d = 0,\n          e = function e(a, c, _e) {\n        var f;\n        a && (f = b[d][c], delete f.idMap[f.indexMap[_e]], delete f.indexMap[_e], a.remove());\n      };\n\n      for (; d < c; d += 1) {\n        _mapSubFnBackward(b[d], e);\n      }\n\n      a._oldComponentStore.length = 0;\n    }\n  }, {\n    key: \"getChild\",\n    value: function getChild(a, b) {\n      var c,\n          d = this._componentStore;\n      return this._searchChildren(a, function (a) {\n        c = a;\n      }, b), c || d;\n    }\n  }, {\n    key: \"_searchChildren\",\n    value: function _searchChildren(a, b, c) {\n      var d,\n          e,\n          f,\n          g,\n          h = this,\n          j = h._componentStore;\n      if (a ? _mapSubFnBackward(j, function (b, h, k) {\n        if (d = j[h], f = d.indexMap, f[k] === a && (!c || c === h)) return g = b, e = k, c = h, !0;\n      }) : g = j[c] && j[c].elemStore, g) return b(g, e, c);\n    }\n  }, {\n    key: \"getChildren\",\n    value: function getChildren(a) {\n      return a ? this._componentStore[a] && this._componentStore[a].elemStore : this._componentStore;\n    }\n  }, {\n    key: \"detachChild\",\n    value: function detachChild(a) {\n      var b,\n          c,\n          d = this,\n          e = d._componentStore;\n      return a === UNDEF ? UNDEF : (d._searchChildren(a, function (a, f, g) {\n        c = e[g], c.elemStore.splice(f, 1), delete c.idMap[c.indexMap[f]], delete c.indexMap[f], a._setLinkedParent(UNDEF), b = a, d.fireEvent('childdetached', {\n          detachedChild: b\n        });\n      }), b);\n    }\n  }]);\n\n  return SmartRenderer;\n}(ComponentBase);\n\nexport default SmartRenderer;","map":null,"metadata":{},"sourceType":"module"}