{"ast":null,"code":"import _classCallCheck from \"F:\\\\App Store\\\\Coding\\\\Github_Download\\\\JS-\\\\React\\u9879\\u76EE\\\\react-mall\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"F:\\\\App Store\\\\Coding\\\\Github_Download\\\\JS-\\\\React\\u9879\\u76EE\\\\react-mall\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"F:\\\\App Store\\\\Coding\\\\Github_Download\\\\JS-\\\\React\\u9879\\u76EE\\\\react-mall\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _assertThisInitialized from \"F:\\\\App Store\\\\Coding\\\\Github_Download\\\\JS-\\\\React\\u9879\\u76EE\\\\react-mall\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";\nimport _getPrototypeOf from \"F:\\\\App Store\\\\Coding\\\\Github_Download\\\\JS-\\\\React\\u9879\\u76EE\\\\react-mall\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _get from \"F:\\\\App Store\\\\Coding\\\\Github_Download\\\\JS-\\\\React\\u9879\\u76EE\\\\react-mall\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/get\";\nimport _inherits from \"F:\\\\App Store\\\\Coding\\\\Github_Download\\\\JS-\\\\React\\u9879\\u76EE\\\\react-mall\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport Base from './input-base';\nimport { getMouseCoordinate, isFirefox } from '../../../fc-core/src/lib';\n\nvar UNDEF,\n    min = Math.min,\n    abs = Math.abs,\n    getRectDimension = function getRectDimension(a, b, c, d) {\n  b.x < c.x && (b.x = c.x), b.y < c.y && (b.y = c.y), b.x > c.width + c.x && (b.x = c.width + c.x), b.y > c.height + c.y && (b.y = c.height + c.y);\n  var e,\n      f = b.x - a.x,\n      g = a.y - b.y,\n      h = min(a.x, b.x),\n      i = min(a.y, b.y);\n  return 0 < f && 0 < g ? e = d ? 'ne-resize' : 'e-resize' : 0 > f && 0 < g ? e = d ? 'nw-resize' : 'w-resize' : 0 > f && 0 > g ? e = d ? 'sw-resize' : 'w-resize' : 0 < f && 0 > g && (e = d ? 'se-resize' : 'e-resize'), f = abs(f), g = abs(g), {\n    x: h,\n    y: i,\n    width: f,\n    height: g,\n    cursor: e\n  };\n};\n\nvar InputDragZoom =\n/*#__PURE__*/\nfunction (_Base) {\n  _inherits(InputDragZoom, _Base);\n\n  function InputDragZoom() {\n    var _this;\n\n    _classCallCheck(this, InputDragZoom);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(InputDragZoom).call(this));\n\n    var a = _assertThisInitialized(_this);\n\n    a.controlArr = [{\n      nativeInteraction: ['fc-dragstart'],\n      callback: a.dragStart.bind(a),\n      component: a\n    }, {\n      nativeInteraction: ['fc-dragmove'],\n      callback: a.onDrag.bind(a),\n      component: a\n    }, {\n      nativeInteraction: ['fc-dragend'],\n      callback: a.onDragEnd.bind(a),\n      component: a\n    }], isFirefox && a.controlArr.push({\n      nativeInteraction: ['fc-mousedown'],\n      callback: InputDragZoom.mousedown,\n      component: a\n    }), a._toggle = function () {\n      a._checkStackLen() && a.toggle();\n    };\n    return _this;\n  }\n\n  _createClass(InputDragZoom, [{\n    key: \"getName\",\n    value: function getName() {\n      return 'dragZoomIn';\n    }\n  }, {\n    key: \"configure\",\n    value: function configure() {\n      _get(_getPrototypeOf(InputDragZoom.prototype), \"configure\", this).call(this);\n\n      var a = this,\n          b = a.getLinkedParent(),\n          c = a.config;\n      c.boxStyle = c.boxStyle || {\n        \"stroke-width\": 1,\n        stroke: 'red',\n        fill: '#00FF00',\n        opacity: .2,\n        cursor: 'ne-resize'\n      }, a.config.skipGraphics || a.setLinkedItem('button', a.createButton({\n        icon: 'zoomModeIcon',\n        tooltext: a.config.tooltext,\n        handlers: {\n          click: a._toggle\n        },\n        state: 'activated'\n      })), a.enable('pressed'), b.registerDependancy([{\n        derivedInteraction: ['pinenabled', 'pindisabled', 'panenabled', 'pandisabled'],\n        callback: a.dependancyFn,\n        component: a\n      }]);\n    }\n  }, {\n    key: \"setControl\",\n    value: function setControl() {\n      var a = this,\n          b = a.getLinkedParent(),\n          c = a.getLinkedItem('button'),\n          d = a.controlArr;\n      b.releaseControl(d), a.isEnabled() && b.getControl(d), c && c.setCurrentState(a.isEnabled() ? a.config.state : 'disabled');\n    }\n  }, {\n    key: \"getCoordinates\",\n    value: function getCoordinates(a) {\n      var b = this.getFromEnv('chart'),\n          c = getMouseCoordinate(b.getFromEnv('chart-container'), a, b);\n      return {\n        x: c.chartX,\n        y: c.chartY\n      };\n    }\n  }, {\n    key: \"inCanvasLimit\",\n    value: function inCanvasLimit(a) {\n      var b = this.getFromEnv('canvas').getGraphicalElement('canvasElement').attrs,\n          c = b.x,\n          d = b.y,\n          e = a.x - b.x,\n          f = a.y - b.y,\n          g = b.width - e,\n          h = b.height - f;\n      return a.x > c && a.y > d && a.width < g && a.height < h;\n    }\n  }, {\n    key: \"drawBox\",\n    value: function drawBox() {\n      var a,\n          b = this,\n          c = b.config,\n          d = b.getGraphicalElement('box'),\n          e = b.getFromEnv('paper'),\n          f = b.getFromEnv('canvas').getGraphicalElement('canvasElement').attrs;\n      d || (d = b.addGraphicalElement('box', e.rect()), d.attr(c.boxStyle)), a = getRectDimension(b.dragBoxConfig.startPos, b.dragBoxConfig.currentPos, f, b.getFromEnv('chart').isXY), c.scaleX || (a.x = f.x, a.width = f.width), c.scaleY || (a.y = f.y, a.height = f.height), d.attr(a), d.show();\n    }\n  }, {\n    key: \"onDragEnd\",\n    value: function onDragEnd(a) {\n      var b,\n          c,\n          d,\n          e,\n          f = this,\n          g = f.config,\n          h = f.getFromEnv('canvas').getGraphicalElement('canvasElement').attrs,\n          i = f.getGraphicalElement('box') || {},\n          j = i.attrs;\n      j && g.dragmove && (g.dragmove = !1, i.hide(), g.startPosX = b = (j.x - h.x) / h.width, g.endPosX = c = (j.x + j.width - h.x) / h.width, g.startPosY = d = (j.y - h.y) / h.height, g.endPosY = e = (j.y + j.height - h.y) / h.height, .01 > c - b || .01 > e - d || f.zoomTo(UNDEF, UNDEF, a));\n    }\n  }, {\n    key: \"zoomTo\",\n    value: function zoomTo(a, b, c) {\n      var d,\n          e,\n          f,\n          g,\n          h,\n          i,\n          j,\n          k,\n          l = this,\n          m = l.getFromEnv('axesObArr'),\n          n = l.config,\n          o = !1,\n          p = {},\n          q = n.catZoomLimit - 1;\n      m.forEach(function (m) {\n        var r = Math.round,\n            s = m.axis,\n            t = s.getVisibleConfig(),\n            u = m.isY ? t.maxValue : t.minValue,\n            v = t.maxValue - t.minValue;\n        m.isY ? (g = d = a === UNDEF ? u - v * n.endPosY : a, i = e = b === UNDEF ? u - n.startPosY * v : b) : (h = d = a === UNDEF ? u + n.startPosX * v : a, j = e = b === UNDEF ? u + v * n.endPosX : b, p = l.constructor._getZoomInfo(h, j, s)), q && !s.config.isVertical && r(e - d) < q && (d = r(d), e = d + q), (1 < v || 1 < e - d) && (n.dragendFn && 'function' == typeof n.dragendFn && n.dragendFn(c, d, e), k = s.setVisibleConfig(d, e), o = o || k, m.stack.push(t), f = m.stack.length + 1);\n      }), o && l._raiseZoomEvents('zoomin', 'zoomedin', Object.assign(p, {\n        level: f,\n        startX: h,\n        endX: j,\n        startY: g,\n        endY: i\n      }, {\n        originalEvent: c && c.originalEvent\n      }));\n    }\n  }, {\n    key: \"onDrag\",\n    value: function onDrag(a) {\n      var b = this,\n          c = b.config,\n          d = b.getCoordinates(a.originalEvent);\n      c.dragmove = !0, this.getFromEnv('animationManager').setAnimationState('drag'), c.dragmoveFn && 'function' == typeof c.dragmoveFn && c.dragmoveFn(a), b.dragBoxConfig.currentPos = d, b.drawBox();\n    }\n  }, {\n    key: \"dragStart\",\n    value: function dragStart(a) {\n      var b = this,\n          c = b.config,\n          d = b.getCoordinates(a.originalEvent);\n      c.dragstartFn && 'function' == typeof c.dragstartFn && c.dragstartFn(a), b.dragBoxConfig = {\n        startPos: d,\n        currentPos: d\n      };\n    }\n  }, {\n    key: \"enable\",\n    value: function enable() {\n      var a = this;\n      !0 !== a.config.enabled && (a.config.enabled = !0, a.config.state = 'pressed', a.fireEvent('dragzoomenabled'), a.setControl());\n    }\n  }, {\n    key: \"disable\",\n    value: function disable() {\n      var a = this;\n      !1 !== a.config.enabled && (a.config.enabled = !1, a.config.state = 'activated', a.fireEvent('dragzoomdisabled'), a.setControl());\n    }\n  }, {\n    key: \"dependancyFn\",\n    value: function dependancyFn(a) {\n      'pinenabled' === a.type || 'panenabled' === a.type ? this.disable() : ('pindisabled' === a.type || 'pandisabled' === a.type) && this.enable();\n    }\n  }], [{\n    key: \"mousedown\",\n    value: function mousedown(a) {\n      a && a.preventDefault();\n    }\n  }]);\n\n  return InputDragZoom;\n}(Base);\n\nexport default InputDragZoom;","map":null,"metadata":{},"sourceType":"module"}